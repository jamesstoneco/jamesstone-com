<!DOCTYPE html>
<!-- paulirish.com/2008/conditional-stylesheets-vs-css-hacks-answer-neither/ -->
<!--[if lt IE 7 ]> <html class="ie6" lang="en"> <![endif]-->
<!--[if IE 7 ]>    <html class="ie7" lang="en"> <![endif]-->
<!--[if IE 8 ]>    <html class="ie8" lang="en"> <![endif]-->
<!--[if (gte IE 9)|!(IE)]><!--> <html lang="en"> <!--<![endif]-->
  <head>
    <meta charset="utf-8" />
    <meta name="google-site-verification" content="9FUywMd926za9lLIK5X7myny7HYoAF48CHemANB8Zu0" />
    <meta name='yandex-verification' content='4d1b71b148f932e6' />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    
    
    <meta name="description" content="">
    
    <title>The Event Driven jQuery Plugin Pattern with four04kids</title>
    <link href="/stylesheets/app-5d956af6.css" media="screen" rel="stylesheet" type="text/css" />
    <script src="/javascripts/vendor/modernizr-8c8a2ced.js" defer="defer" type="text/javascript"></script>
  </head>

  <body>

    

<div class="off-canvas-wrap">
  <div class="inner-wrap">
    <nav class="tab-bar">
      <section class="left-small">
        <a class="left-off-canvas-toggle menu-icon" ><span></span></a>
      </section>

      <section class="middle tab-bar-section">
        <h2 class="title"><a href="/">manofstone.com</a></h2>
      </section>



      <!-- <section class="right-small">
        <a class="right-off-canvas-toggle menu-icon" ><span></span></a>
      </section> -->



    </nav>

    <aside class="left-off-canvas-menu">
      <ul class="off-canvas-list">
        <li><label>James Stone</label></li>
        <li><a href="/">Home</a></li>
        <li><a href="/about">About</a></li>
        <li><a href="/teaching">Teaching</a></li>
        <li><a href="/blog">Blog</a></li>
        <li><a href="/studio">Studio</a></li>
        <li><a href="/contact">Contact</a></li>
      </ul>
    </aside>

    <aside class="right-off-canvas-menu">
      <ul class="off-canvas-list">
        <li><label>Users</label></li>
        <li><a href="#">Hari Seldon</a></li>
        ...
      </ul>
    </aside>

    <section class="main-section">
      <!-- content goes here -->


    
<div class="content-top-spacing"></div>

<div class="row">
  <div class="large-12 columns">
    <h2 align="center">The Event Driven jQuery Plugin Pattern with four04kids</h2>
    <p align="center">
      Written by James Stone <time class="timeago published" datetime="2013-09-23T00:00:00+02:00">September 23, 2013 12:00 AM</time>

    </p>
  </div>
</div>

<div class="row">
  <div class="large-8 large-centered columns">
    <div class="entry-content">
      
      
        <div class="row">
          <div class="small-12 medium-8 medium-centered large-12 columns">
            <p><img src="/blog/featured-images/pattern-giraffe-36ceb0b4.jpg"></p>
          </div>
        </div>
      
      <p>Last night I was chatting with <a href="http://jeffreyhorn.com/">Jeffrey Horn</a> and found out he was at Startup Weekend in Seattle and working on a new project called <a href="http://404kids.org/">four04kids</a>. Pretty cool idea, they encourage you to add a simple javascript to your 404 error page and it asks if you have seen missing children in your area. I thought this was a great idea and something really positive they were bringing to the community and added their js embed to <a href="http://www.manofstone.com/WAT">my error page on this site</a>.</p>

<p></p>

<p>I chatted with him for a bit about their future directions and that a jQuery Plugin version was in the road map. In the spirit of Open Source and Gitrdone I jumped in to refactor their existing code into a proper jQuery Plugin to the best of my ability. What follows is what I learned in the several hour process and how I implemented the Event Driven jQuery Plugin Pattern as written about by Doug Avery in his excellent article titled, <a href="http://viget.com/inspire/jquery-plugin-patterns">A Few jQuery Plugin Patterns</a> on the <a href="http://viget.com/inspire/">Viget Inspire Blog</a>.</p>

<p>If you have any questions or suggestions on how to refactor this I would love to hear from you in the comments. This is just the solution I built with the time I had available.</p>

<p>So I took a look at the <a href="https://github.com/theverything/four04kids/blob/270618d3cca97b2d4392e745e9c610082d361a80/embed/src/embed.coffee">original javascript</a> at had a go at it.</p>

<p>I broke it down into the following pieces of functionality:</p>

<ul>
<li>Loading JSON data via the API</li>
<li>Going to the next kid, excluding the last viewed on when the &ldquo;no&rdquo; button is pressed</li>
<li>Adding custom CSS</li>
<li>Replacing or adding a DIV and filling a template with data from it</li>
</ul>

<p>Lets take a look at the full source in CoffeeScript:</p>

<pre><code class="coffeescript">$.fn.four04 = (options) -&gt;
  settings = $.extend(
    wrapperClass: &quot;kids404-wrapper&quot;
    kidsId: &quot;kids404&quot;
    apiURL: &quot;http://404kids.org/api/random&quot;
    htmlTemplate: &quot;&quot;&quot;
&lt;div class=&quot;{{wrapperClass}}&quot;&gt;
  &lt;div class=&quot;front&quot;&gt;
    &lt;h2&gt;Missing Person Near &lt;span class=&quot;geo-city&quot;&gt;Seattle&lt;/span&gt;&lt;/h2&gt;
    &lt;div class=&quot;image&quot;&gt;
      &lt;img src=&quot;http://missingkids.com/{{image_url}}&quot;&gt;
    &lt;/div&gt;
    &lt;div class=&quot;info&quot;&gt;
      &lt;h3&gt;{{full_name}}&lt;/h3&gt;
      &lt;h4&gt;Current Age {{ageString}}&lt;/h4&gt;
      &lt;h4&gt;Missing From {{missing_city}}, {{missing_state}}
      &lt;br&gt;since {{month}} {{day}}, {{year}}&lt;/h4&gt;
      &lt;h4 class=&quot;question&quot;&gt;Have You Seen This Person?&lt;/h4&gt;
      &lt;br&gt;
      &lt;a href=&quot;{{missingLink}}&quot; class=&quot;btn&quot;&gt;SEEN&lt;/a&gt;
      &lt;a href=&quot;#&quot; class=&quot;btn&quot; id=&quot;new-kid&quot;&gt;NO&lt;/a&gt;
    &lt;/div&gt;
    &lt;div class=&quot;more-info&quot; onclick=&quot;document.getElementById(&#039;kids404&#039;).className = &#039;flipped&#039;;&quot;&gt;
      &lt;span&gt;?&lt;/span&gt;
    &lt;/div&gt;
  &lt;/div&gt;
  &lt;div class=&quot;back&quot;&gt;
    &lt;p&gt;This service is brought to you by &lt;a href=&quot;http://404kids.org&quot;&gt;404kids&lt;/a&gt;, and is intended to help reclaim
    the visibility and independence of missing children.&lt;/p&gt;

    &lt;p&gt;If you would like to aid in
    the search for missing and exploited adolescents, please &lt;a href=&quot;http://404kids.org/docs&quot;&gt;add this widget to your site&lt;/a&gt;.&lt;/p&gt;

    &lt;p&gt;If you have any information to report on one of our featured subjects, we urge you to &lt;a href=&quot;{{missingLink}}&quot;&gt;fill out a report&lt;/a&gt; immediately.&lt;/p&gt;
    &lt;div class=&quot;more-info&quot; onclick=&quot;document.getElementById(&#039;kids404&#039;).className = &#039;&#039;;&quot;&gt;
      &lt;span&gt;x&lt;/span&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;
&quot;&quot;&quot;
  , options)
  @each -&gt;
    $this = $(this)
    $this.attr(&quot;id&quot;, &quot;#{settings.kidsId}&quot;)
    newKid = (kid_id) -&gt;
      apiCall = settings.apiURL
      apiCall = apiCall + &quot;?exclude=#{kid_id}&quot; if kid_id
      jqxhr = $.getJSON apiCall, (data) -&gt;
        kid = data.kid
        months = [
          &quot;January&quot;
          &quot;February&quot;
          &quot;March&quot;
          &quot;April&quot;
          &quot;May&quot;
          &quot;June&quot;
          &quot;July&quot;
          &quot;August&quot;
          &quot;September&quot;
          &quot;October&quot;
          &quot;November&quot;
          &quot;December&quot;
        ]
        $this.kidView = 
          wrapperClass: settings.wrapperClass
          image_url: kid.image_url
          full_name: kid.full_name
          ageString: if kid.age then &quot;#{kid.age} Years Old&quot; else &quot;Age Not Provided&quot;
          missing_city: kid.missing_city
          missing_state: kid.missing_state
          year: parseInt(kid.missing_date.slice(0,4), 10)
          month: months[parseInt(kid.missing_date.slice(5,7), 10)]
          day: parseInt(kid.missing_date.slice(8,10), 10)
          missingLink: kid.missing_url
          id: kid.id
      .done( -&gt;
        $this.html Mustache.render(settings.htmlTemplate, $this.kidView)
        # attach click event after generating html
        $this.find(&quot;#new-kid&quot;).click (event) -&gt;
          event.preventDefault()
          $this.trigger &quot;newKid&quot;
        )
      .error( -&gt;
        console.log &quot;error loading json data.&quot;
        )
    $this.bind
      newKid: newKid
    $this.ready -&gt; # show the first kid after everything else
      $this.trigger &quot;newKid&quot;      

</code></pre>

<p>First I define some defaults that can be overrided when calling the plugin. In these defaults I also place a mustache template called htmlTemplate. Next, by calling <span class="inline-code">@each</span> allows jQuery calls to be chained to this plugin. The function <span class="inline-code">newKid (kid_id)</span> does a lot of the heavy lifting, pulling the data from json and returning the template. Following this I bind <span class="inline-code">newKid</span> to <span class="inline-code">$this</span>. Finally <span class="inline-code">$this.ready</span> calls newKid with <span class="inline-code">$this.trigger &ldquo;newKid&rdquo;</span>.</p>

<p>I moved the adding of the trigger to the &ldquo;No&rdquo; button to the end of the <span class="inline-code">.done()</span> callback for the <span class="inline-code">getJSON</span> method. This ensures that the button has been created by the template before binding it to the correct function. If you try and do this in another part of the plugin, such as in the same scope as <span class="inline-code">$this.bind</span> the problem is that the button has not been created yet, because we are waiting for the <span class="inline-code">getJSON</span> call to complete.</p>

<p>You can take a look at my final <a href="https://github.com/manofstone/four04kids/blob/d3983049c6f78d9e648cab617c0523d435f44537/embed/src/embed-jquery.coffee">CoffeeScript</a> and <a href="https://github.com/manofstone/four04kids/blob/d3983049c6f78d9e648cab617c0523d435f44537/embed/src/embed-jquery.js">Generated JavaScript</a> vesions on my final <a href="https://github.com/manofstone/four04kids/commit/d3983049c6f78d9e648cab617c0523d435f44537">GitHub commit</a> for the session.</p>

    </div>
  </div>
</div>

  <div class="row">
  <div class="small-10 small-centered medium-10 large-10 columns panel radius f4callout">
    <h3 class="alt-text">Free Zurb Foundation Quick Reference</h3>
    <p class="alt-text">If you enjoyed this post you might also enjoy my newsletter. If you sign up before November 30th I will send you my Zurb Foundation Quick Reference absolutely free.</p>
    <div class="row">
      <div class="medium-6 large-6 columns">
        <p> <img src="/images/zurb-foundation-blueprints/quick-ref-placed-29da5bdb.jpg" alt=""> </p>
      </div>
      <div class="medium-6 large-6 columns">
        <!-- Begin MailChimp Signup Form -->
        <form action="http://jamesjamesjames.us5.list-manage1.com/subscribe/post?u=d4dbc5cdf8&amp;id=30ca2edfef" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="custom" target="_blank" novalidate data-abide>
        <input type="hidden" name="REF" id="mce-REF" value="/blog/the-event-driven-jquery-plugin-pattern-with-four04kids/">

<!--           <div class="row">
            <div class="medium-12 large-12 columns">
              <div class="name-field">
                <input type="text" name="FNAME" id="mce-FNAME" placeholder="first name" required pattern="[a-zA-Z]+">
                <small class="error">Your first name is required.</small>
              </div>
            </div>
          </div> -->
          <div class="row">
            <div class="medium-12 large-12 columns">
              <div class="email-field">
                <input type="email" name="EMAIL" class="required email" id="mce-EMAIL" placeholder="name@domain.com" required>
                <small class="error">You must enter your email to subscribe and download.</small>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="medium-12 large-12 columns">
              <div id="mce-responses" class="clear">
                <div class="response" id="mce-error-response" style="display:none"></div>
                <div class="response" id="mce-success-response" style="display:none"></div>
              </div>
              <input type="submit" value="Download my Free Quick Reference Now &raquo;" name="subscribe" id="mc-embedded-subscribe" class="button cta radius expand">
            </div>
          </div>
        </form>
    <p class="alt-text">SPAM Sucks. Thats why I promise only to send you foundation goodness about two to three times per month. Unsubscribe at anytime.</p>

      </div>
    </div>
  </div>
</div>

<div class="row">
  <div class="large-8 large-centered columns">
    <!-- comments -->
    <div id="disqus_thread"></div>
    <script type="text/javascript">
      var disqus_shortname = 'manofstone';
      /* * * DON'T EDIT BELOW THIS LINE * * */
      (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
  </div>
</div>



    

<div id="mos-top-footer">
  <div class="row">
    <div class="medium-3 large-3 columns">
      <h4 class="alt-text">Categories</h4>
      <ul class="side-nav">
        
        
        <li><a href="/blog/code/">code</a></a></li>
        
        
        
        
        
        
        
        <li><a href="/blog/01sj/">01sj</a></a></li>
        
        
        
        
        
        
        
        
        
        
        
        <li><a href="/blog/ecology/">ecology</a></a></li>
        
        
        
        <li><a href="/blog/fcp/">fcp</a></a></li>
        
        
        
        <li><a href="/blog/physical-computing/">physical computing</a></a></li>
        
        
        
        <li><a href="/blog/video/">video</a></a></li>
        
        
        
        
        
        
        
        <li><a href="/blog/arduino/">arduino</a></a></li>
        
        
        
        <li><a href="/blog/robot/">robot</a></a></li>
        
        
        
        
        
        
        
        <li><a href="/blog/isea2011/">isea2011</a></a></li>
        
        
        
        <li><a href="/blog/performance/">performance</a></a></li>
        
        
        
        
        
        <li><a href="/blog/wearable/">wearable</a></a></li>
        
        
        
        
        
        
        
        <li><a href="/blog/processing/">processing</a></a></li>
        
        
        
        
        
        
        
        <li><a href="/blog/rhizome/">rhizome</a></a></li>
        
        
        
        
        
        
        
        
        
        
        
        <li><a href="/blog/java/">java</a></a></li>
        
        
        
        
        
        
        
        
        
        
        
        
        
        <li><a href="/blog/jquery/">jquery</a></a></li>
        
        
        
        
        
        
        
        
        
        
        
        <li><a href="/blog/studio/">studio</a></a></li>
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        <li><a href="/blog/zurb-foundation/">zurb-foundation</a></a></li>
        
        
        
        
        
        
        
        <li><a href="/blog/patterns/">patterns</a></a></li>
        
        
        
        
        
        
        
        
        
        
        
        
        
        <li><a href="/blog/foundation-quick-tips/">foundation-quick-tips</a></a></li>
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        <li><a href="/blog/ruby/">ruby</a></a></li>
        
        
        
        
        
        
        
        
        
        
        
        
      </ul>
    </div>

    <div class="medium-3 large-3 columns">
      <h4 class="alt-text">Top Posts</h4>
      <ul class="side-nav">
      <li><a href="/blog/compass-sass-vs-sassc-for-zurb-foundation-4/">Compass Sass vs Sassc for Zurb Foundation 4</a></li>
        <li><a href="/blog/zurb-foundation-5-medium-grid/">Zurb Foundation 5 Medium Grid</a></li>
        <li><a href="/blog/using-zurb-ink-with-mailchimp/">Using Zurb Ink with MailChimp</a></li>
        <li><a href="/blog/10-things-i-love-about-ruby/">10 Things I Love About Ruby</a></li>
        <li><a href="/blog/semantic-ui-style-layouts-in-zurb-foundation/">Semantic UI Style Layouts in Zurb Foundation</a></li>
        <li><a href="/blog/design-patterns-in-processing-the-agent/">Design Patterns in Processing the Agent</a></li>
        <li><a href="/blog/ruby-slim-and-zurb-foundation/">Ruby Slim And Zurb Foundation</a></li>
        <li><a href="/blog/shoehorn-zurb-foundation-into-weird-stuff/">Shoehorn Zurb Foundation Into Weird Stuff</a></li>
        <li><a href="/blog/dotrb-ruby-confrence-in-paris-france/">Dotrb Ruby Confrence in Paris France</a></li>
        <li><a href="/blog/the-event-driven-jquery-plugin-pattern-with-four04kids/">The Event Driven Jquery Plugin Pattern With Four04kids</a></li>
      </ul>
    </div>
    <div class="medium-3 large-3 columns">
      <h4 class="alt-text">Products</h4>
      <ul class="side-nav">
        <li><a href="/zurb-foundation-blueprints">Zurb Foundation 4 Blueprints</a></li>
        <li><a href="https://gum.co/foundation4quickref">Zurb Foundation 4 Quick Reference</a></li>
        <li><a href="https://leanpub.com/aoeuandi">AOEU and I, Learn How to Type with the Dvorak Keyboard Layout, the Leading Alternative to QWERTY</a></li>
      </ul>
    </div>
    <div class="medium-3 large-3 columns">
      <h4 class="alt-text">Latest Links</h4>
      <ul class="side-nav">
        <li><a href="http://bitly.com/bundles/manofstone/8">frontend-five-001</a></li>
        <li><a href="http://bitly.com/bundles/manofstone/9">4-pub-001</a></li>
        <li><a href="http://bitly.com/u/manofstone">my live bitly stream</a></li>
      </ul>
    </div>
  </div>
  <div class="row">
    <div class="medium-12 large-12 columns">
      <p class="text-center"><small>Copyright 2013, James Stone, All Rights Reserved.</small></p>

    </div>
  </div>
</div>

<div id="mos-footer">
  <div class="row">
    <div class="medium-2 large-2 columns">
      <h4 class="alt-text text-right">James Stone</h4>
    </div>
    <div class="medium-6 large-6 columns hide-for-small">
      <ul class="inline-list" id="mos-footer-nav">

        <li><a href="/">Home</a></li>
        <li><a href="about">About</a></li>
        <li><a href="teaching">Teaching</a></li>
        <li><a href="blog">Blog</a></li>
        <li><a href="studio">Studio</a></li>
        <li><a href="contact">Contact</a></li>
      </ul>
    </div>
    <div class="medium-4 large-4 columns hide-for-small">
      <ul class="inline-list" id="mos-footer-social-nav">
        <li><a href="http://feeds.feedburner.com/jamesmanofstone" rel="alternate" type="application/rss+xml"><i class="fi-rss"></i></a></li>
        <li><a href="http://www.twitter.com/manofstone"><i class="fi-social-twitter"></i></a></li>
        <li><a href="https://github.com/manofstone"><i class="fi-social-github"></i></a></li>
        <li><a href="http://stackoverflow.com/users/1560583"><i class="fi-social-stack-overflow"></i></a></li>
        <li><a href="http://www.linkedin.com/in/manofstone"><i class="fi-social-linkedin"></i></a></li>
      </ul>
    </div>
  </div>
  <div class="row">
    <div class="medium-12 large-12 columns">
    <p>&nbsp;</p>
    </div>
  </div>
</div>

    </section><!-- close the off-canvas menu -->
    <a class="exit-off-canvas"></a>
  </div>
</div>

    <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js" defer></script>

    <script src="/javascripts/application-def5725c.js" defer="defer" type="text/javascript"></script>

    <script type="text/javascript" defer="defer">
var clicky_site_ids = clicky_site_ids || [];
clicky_site_ids.push(100671419);
(function() {
  var s = document.createElement('script');
  s.type = 'text/javascript';
  s.async = true;
  s.src = '//static.getclicky.com/js';
  ( document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0] ).appendChild( s );
})();
</script>
<noscript><p><img alt="Clicky" width="1" height="1" src="//in.getclicky.com/100671419ns.gif" /></p></noscript>


  </body>
</html>
