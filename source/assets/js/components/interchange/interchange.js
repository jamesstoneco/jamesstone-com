!function(){"use strict";function zfInterchange(foundationApi,$compile,$http,$templateCache){function link(scope,element,attrs,ctrl,transclude){function templateLoader(templateUrl){return $http.get(templateUrl,{cache:$templateCache})}function matched(){var count=scenarios.length,matches=[];if(count>0)for(;count--;){var mq,rule=scenarios[count].media;mq=matchMedia(namedQueries[rule]?namedQueries[rule]:rule),mq.matches&&matches.push({ind:count})}return matches}function collectInformation(parentElement){scenarios=[],innerTemplates=[];var elements=parentElement.children(),i=0;angular.forEach(elements,function(el){var elem=angular.element(el);elem.attr("src")&&elem.attr("src").match(/.html$/)?scenarios[i]={media:elem.attr("media"),src:elem.attr("src")}:(innerTemplates[i]=elem,scenarios[i]={media:elem.attr("media"),templ:i}),i++})}function checkScenario(scenario){return!current||current!==scenario}var childScope,current,scenarios,innerTemplates,namedQueries={"default":"only screen",landscape:"only screen and (orientation: landscape)",portrait:"only screen and (orientation: portrait)",retina:"only screen and (-webkit-min-device-pixel-ratio: 2),only screen and (min--moz-device-pixel-ratio: 2),only screen and (-o-min-device-pixel-ratio: 2/1),only screen and (min-device-pixel-ratio: 2),only screen and (min-resolution: 192dpi),only screen and (min-resolution: 2dppx)"},globalQueries=foundationApi.getSettings().mediaQueries;namedQueries=angular.extend(namedQueries,globalQueries),foundationApi.subscribe("resize",function(){transclude(function(clone,newScope){scenarios&&innerTemplates||collectInformation(clone);var ruleMatches=matched(),scenario=0===ruleMatches.length?null:scenarios[ruleMatches[0].ind];if(scenario&&checkScenario(scenario)){if(childScope&&(childScope.$destroy(),childScope=null),"undefined"!=typeof scenario.templ){childScope=newScope;var tmp=document.createElement("div");tmp.appendChild(innerTemplates[scenario.templ][0]),element.html(tmp.innerHTML),$compile(element.contents())(childScope),current=scenario}else{var loader=templateLoader(scenario.src);loader.success(function(html){childScope=newScope,element.html(html)}).then(function(){$compile(element.contents())(childScope),current=scenario})}}})}),foundationApi.publish("resize","initial resize")}var directive={restrict:"EA",transclude:"element",scope:{position:"@"},replace:!0,template:"<div></div>",link:link};return directive}angular.module("foundation.interchange",["foundation.core"]).directive("zfInterchange",zfInterchange),zfInterchange.$inject=["FoundationApi","$compile","$http","$templateCache","$animate"]}();